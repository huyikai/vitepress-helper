import e from"fs-extra";import t from"globby";import l from"gray-matter";import{v4 as r}from"uuid";import{treeToArray as o}from"tree-conver";const n=(e,t)=>e.frontMatter.date<t.frontMatter.date?1:-1;var i=async o=>{const{directory:i}=o,a=await t([`${i}/**/**.md`],{ignore:["node_modules","README.md","packages"]});let s=await Promise.all(a.map((async t=>{const o=await e.readFile(t,"utf-8"),n=l(o);return{frontMatter:n.data,link:t,content:n.content.replace(/[^a-zA-Z0-9._ ]+/g,"").toLowerCase(),uuid:r()}})));return s=s.filter((e=>!e.frontMatter.page)),s.sort(n),s},a=e=>{const{pages:t,directory:l}=e;return(e=>{const t=e.map((e=>({...e,link:e.link.split(`${l}/`)[1],level:e.link.split(`${l}/`)[1].split("/").length-1})));console.log(t.filter((e=>e.level>0)));const r=t.filter((e=>e.level>0)).map((e=>e.link.split("/").slice(0,-1)));console.log(r);const n=(e=>{const t={};e.forEach((e=>{let l=t;e.forEach((e=>{l[e]||(l[e]={text:e,children:{}}),l=l[e].children}))}));const l=e=>Object.values(e).map((e=>(e.children=l(e.children),e)));return l(t)})(r);return console.log(JSON.stringify(n)),console.log(o(n)),[]})(t.filter((e=>e.link.includes(`${l}/`))))},s=e=>{const{pages:t,directory:l,collapsible:r}=e;let o=[],n=[];for(let e of t){let t=e.link.replace(`${l}/`,"").split("/").filter(((e,t)=>e.indexOf(".md")<0&&t<2)).join("/");t.indexOf("/")>=0&&o.push(t);let r=e.link.replace(`${l}/`,"").split("/");for(let e=0,t=r.length;e<t;e++){let t=r[e],l={text:t.replace(".md",""),key:t,parentKey:e>0?r[e-1]:void 0,link:`/${r.join("/")}`};n.push(l)}}function i(e,t=""){const l=new Map;return e.filter((e=>!l.has(t?e[t]:e)&&l.set(t?e[t]:e,1)))}o=o.filter((e=>!["","/"].includes(e))),o.sort(),n=n.sort((function(e,t){var l=e.text,r=t.text;return l<r?-1:l>r?1:0})),o=i(o);let a={};for(let e of o)a[e]=[{text:e.split("/").filter((e=>e)).splice(-1,1)[0],key:e.split("/").filter((e=>e)).splice(-1,1)[0],parentKey:void 0}];for(let e in a)s(a[e][0]);function s(e){let t=n.filter((t=>e.key===t.parentKey));if(t=i(t,"key"),t){for(let e of t)s(e);!(e.hasOwnProperty("link")&&e.key.indexOf(".md")>=0)&&delete e.link,e.items=t,e.collapsible=r,e.collapsed=null}}return a},c=async(e={directory:"docs",collapsible:!0})=>{const t=await i(e),l={pages:t,...e};return{nav:a(l),sidebar:s(l),pages:t}};export{c as default,c as init,a as nav,i as pages,s as sidebar};
//# sourceMappingURL=index.esm.js.map
